---
description: назначение, особенности, отличия
---

# RIPv2 и BGP

## RIPv2

Кратко: простой дистанционно-векторный IGP. Подходит для небольших сетей. Быстро настраивается, медленно конвергирует.

### Основные свойства

* Тип: distance-vector.
* Метрика: **hop count** (количество переходов). Максимум $$15$$; $$16$$ = unreachable.
* Период обновления: обновления каждые **30 s**. Таймеры: invalid = **180 s**, flush = **240 s** (по умолчанию).
* Поддерживает CIDR и аутентификацию (RIPv2 vs старый RIPv1).
* Обновления отправляются по multicast `224.0.0.9`.
* Administrative Distance (по умолчанию) = **120**.

### Поведение и ограничения

* Медленная конвергенция. Склонен к петлям. Использует split horizon, route poisoning, hold-down.
* Хорош для простых топологий. Не масштабируется для больших AS.

### Команды (пример Cisco)

```
router rip
 version 2
 network 10.0.0.0
 no auto-summary
```

Проверка:

```
show ip route rip
show ip rip database
```

### Экзаменационные тезисы

1. RIPv2 = hop-count, max 15.
2. Update = 30s, multicast 224.0.0.9.
3. AD = 120.
4. Механизмы против петель: split-horizon, route poisoning, hold-down.

### Вопросы для самопроверки

1. Что означает метрика 16 в RIP?
2. Как RIPv2 предотвращает обратное суммирование (auto-summary)?
3. Какие таймеры у RIPv2 и за что отвечают?

***

## BGP (Border Gateway Protocol)

Кратко: экстерьерный протокол Internet-класса. Управляет обменом префиксами между автономными системами (AS). Очень гибкий и политико-ориентированный.

### Роли и виды сессий

* **eBGP** — между разными AS (обычно соседние роутеры в Internet). TTL обычно 1 (за исключением multihop).
* **iBGP** — внутри одного AS. Требует полных пиров или route-reflectors, чтобы избежать split-horizon iBGP-ограничения.
* BGP работает поверх TCP (порт 179).

### Ключевые атрибуты маршрутов (важнее для выбора)

1. **Weight** (Cisco, локальный) — сначала.
2. **Local Preference** (LOCAL\_PREF) — предпочитается большее.
3. **AS\_PATH** — короче лучше (избегает циклов).
4. **Origin** (IGP < EGP < Incomplete).
5. **MED (Multi-Exit Discriminator)** — предпочитать меньшее.
6. **eBGP over iBGP** и далее критерии как NEXT\_HOP reachability, lowest IGP cost, и т.д. (Это порядок сокращённо; реализации могут добавлять шаги.)

### Политики и фильтрация

* BGP — про политику. Принцип: объявлять, принимать, фильтровать, менять атрибуты (set local-pref, set community, prepend AS\_PATH, set MED).
* Communities — метки для политик (локальные/стандартные).
* Route-maps / prefix-lists / AS-path access-lists — основные инструменты.

### Масштаб и архитектурные элементы

* iBGP требует полной mesh или route-reflector/ confederation.
* Route-reflector уменьшает число iBGP-пиров. Нужно контролировать сабмиссии и политики.

### Поведение и устойчивость

* Конвергенция медленнее IGP, но управляемая политиками.
* BGP не предназначен для частых изменений префиксов (flapping) — используются dampening механизмы.

### Команды (пример Cisco)

```
router bgp 65001
 neighbor 203.0.113.2 remote-as 65002   ! eBGP neighbor
 neighbor 10.0.0.2 remote-as 65001      ! iBGP neighbor (multihop/IBGP)
 network 198.51.100.0 mask 255.255.255.0
```

Проверка:

```
show ip bgp
show ip bgp summary
show ip bgp neighbors
show ip bgp 198.51.100.0
```

### Типичные практические приёмы

* Использовать **local-preference** для выбора исходящего пути внутри AS.
* Препенд AS\_PATH для снижения предпочтения определённого выхода.
* Фильтровать входящие префиксы по длине и source AS.
* Настраивать next-hop-self на iBGP-роутерах, чтобы обеспечить reachability.

### Экзаменационные тезисы

1. BGP работает поверх TCP(179). eBGP между AS, iBGP внутри AS.
2. Ключевые атрибуты: LocalPref, AS\_PATH, MED, NEXT\_HOP.
3. Политики управляют выбором маршрута, не только метрики.
4. iBGP требует mesh либо route-reflector; иначе не будет передачи маршрутов между iBGP-пирами.

### Вопросы для самопроверки

1. В каком порядке BGP смотрит атрибуты при выборе маршрута? (назовите основные)
2. Почему iBGP требует полного mesh или route-reflector?
3. Как с помощью AS\_PATH сделать путь менее предпочтительным?

