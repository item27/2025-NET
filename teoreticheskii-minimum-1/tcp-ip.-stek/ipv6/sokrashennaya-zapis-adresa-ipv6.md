# Сокращенная запись адреса (IPv6)

> Кратко: для удобства сокращают нулевые группы и ведущие нули в каждом 16-битном блоке (hextet). Правила жёсткие — их надо знать, иначе ошибётесь.

### Правила сокращения

1. Представление полное: 8 групп по 4 hex → `hhhh:hhhh:hhhh:hhhh:hhhh:hhhh:hhhh:hhhh`.
2. **Удаление ведущих нулей в каждой группе.**
   * `00ab` → `ab`.
3. **Сжатие подряд идущих групп, равных нулю, в `::`.**
   * Можно использовать **только один** `::` в адресе.
   * `::` заменяет любую последовательность из ≥1 полностью нулевых hextet'ов.
4. Если весь адрес нули → `::`.
5. Префиксы записывают как `addr/﻿n` например $$/64$$ (`2001:db8::/64`).

### Порядок применения (алгоритм)

1. Для каждого hextet убрать ведущие нули.
2. Найти **самую длинную** последовательность полностью нулевых hextet'ов.
3. Заменить её одной `::`.
4. Если есть несколько одинаковых по длине — сжимать **первую** (левую).
5. Нельзя применять `::` для сокращения одиночного нулевого hextet'а, но формально можно; предпочтительно сжимать только длину ≥2 для читабельности.

### Примеры

* Полный: `2001:0db8:0000:0000:0000:ff00:0042:8329` → убрать ведущие нули: `2001:db8:0:0:0:ff00:42:8329` → сжать самый длинный блок `0:0:0` → `2001:db8::ff00:42:8329`.
* Loopback: `0000:0000:0000:0000:0000:0000:0000:0001` → `::1`.
* Unspecified: `0000:0000:0000:0000:0000:0000:0000:0000` → `::`.
* IPv4-mapped: `0000:0000:0000:0000:0000:ffff:c00a:0201` → `::ffff:192.10.2.1` (последние 32 бита отображаются в IPv4 формат).

### Особые случаи

* **Зона интерфейса** для LLA: `fe80::1%eth0` или `fe80::1%3` (Windows/Linux разный синтаксис для номера/имени).
* **IPv4-совместимые/маппированные**: `::ffff:192.0.2.128` используется для представления IPv4 в IPv6.
* **Не более одного `::`**. Пример неверного: `2001::db8::1` — ошибка.

### Проверка и разворачивание

* Развернуть: заменить `::` на нужное число `0000` групп так, чтобы суммарно было 8 групп. Пример: `2001:db8::1` → `2001:0db8:0000:0000:0000:0000:0000:0001`.
* Для подсетей обычно используют $$/64$$. При выводе префикса писать явно: `2001:db8::/64`.

### Короткая шпаргалка

* Удаляйте ведущие нули.
* Заменяйте **самую длинную** последовательность нулей на `::` (только одну).
* `::` означает «ноль группы» и может быть весь адрес.
* Для LLA указывайте `%iface` при необходимости.

### Задачи для практики

1. Сократите `fd12:3456:0000:0000:0000:0000:0000:0000`.
2. Разверните `2001:db8::ff00:42:8329`.
3. Запишите IPv4-mapped `192.0.2.33` в сокращённом IPv6.

Ответы (проверьте сами):

1. `fd12:3456::`
2. `2001:0db8:0000:0000:0000:ff00:0042:8329`
3. `::ffff:192.0.2.33`
